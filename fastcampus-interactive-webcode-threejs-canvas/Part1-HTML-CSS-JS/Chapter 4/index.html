<!doctype html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="./index.css" />
        <title>Fast Bank</title>
    </head>

    <body>
        <div id="main-img-wrapper">
            <img
                width="320"
                src="./img/Lovepik_com-401339128-data-management-data-analysis-icon-free-vector-illustration-mate.png"
                alt="coding image"
            />
        </div>
        <div id="intro-main">
            <p>이미 모두의 은행, 패스트뱅크</p>
            <p>함께 일해요.</p>
            <p id="join-us-text">Join us!</p>
            <img id="down-arrow-icon" src="./img/down-arrow.png" alt="down arrow icon" />
        </div>
        <ul id="list-item-wrapper">
            <li class="list-item">26주적금</li>
            <li class="list-item">저금</li>
            <li class="list-item">패스트캠퍼스</li>
            <li class="list-item">떡볶이</li>
            <li class="list-item">치킨</li>
            <li class="list-item">축구</li>
            <li class="list-item">축구선수</li>
            <li class="list-item">마이너스통장대출</li>
            <li class="list-item">26주적금</li>
            <li class="list-item">저금</li>
            <li class="list-item">패스트캠퍼스</li>
            <li class="list-item">떡볶이</li>
            <li class="list-item">치킨</li>
            <li class="list-item">축구</li>
            <li class="list-item">축구선수</li>
            <li class="list-item">마이너스통장대출</li>
            <li class="list-item">26주적금</li>
            <li class="list-item">저금</li>
            <li class="list-item">패스트캠퍼스</li>
            <li class="list-item">떡볶이</li>
            <li class="list-item">치킨</li>
            <li class="list-item">축구</li>
            <li class="list-item">축구선수</li>
            <li class="list-item">마이너스통장대출</li>
            <li class="list-item">26주적금</li>
            <li class="list-item">저금</li>
            <li class="list-item">패스트캠퍼스</li>
            <li class="list-item">떡볶이</li>
            <li class="list-item">치킨</li>
            <li class="list-item">축구</li>
            <li class="list-item">축구선수</li>
            <li class="list-item">마이너스통장대출</li>
        </ul>
        <main>
            <section id="panel1-img">
                <img id="flying-santa-image" src="./img/santa_flying.png" alt="santa flying" />
            </section>
        </main>
    </body>

    <script>
        /** 화면이 내려갈 때 색이 입혀지는 애니메이션을 적용한다
         * listStyleChangeStartY: list의 색이 입혀지기 시작하는 y좌표
         * listStyleChangeEndY: list의 색이 입혀지기 끝나는 y좌표
         */
        const listStyleChangeStartY = 373;
        const listStyleChangeEndY = 1585;

        const listItems = document.querySelectorAll('.list-item');

        // list의 색이 입혀지는 간격
        const division = (listStyleChangeEndY - listStyleChangeStartY) / listItems.length;

        const panel1Img = document.getElementById('panel1-img');
        const flyingSantaImage = document.getElementById('flying-santa-image');

        window.addEventListener('scroll', () => {
            // * 스크롤이 변할 때 list의 색이 입혀져 있다면, 기존에 입혀진 색을 제거한다
            if (document.getElementById('on')) document.getElementById('on').removeAttribute('id');

            // * 스크롤이 list의 색이 입혀지는 영역 사이에 있다면,
            if (window.scrollY > listStyleChangeStartY && window.scrollY < listStyleChangeEndY) {
                // ? 해당하는 위치를 계산한다
                const targetIndex = Math.round((window.scrollY - listStyleChangeStartY) / division);

                // * 해당 위치의 list에 id를 부여한다
                if (listItems[targetIndex]) listItems[targetIndex].id = 'on';
            }

            // * 산타가 옆에서 튀어나오는 애니메이션을 적용한다
            // * scrollYBottom: 화면의 아래쪽 y좌표
            // ? window의 위치는 화면 최상단이 기준이므로, 화면의 아래쪽 y좌표를 구하기 위해서는 window.scrollY에 화면의 높이를 더해야 한다
            const scrollYBottom = window.scrollY + document.documentElement.clientHeight;

            // * 스크롤을 내려 화면 아래가 산타가 튀어나오는 영역 안에 스크롤이 들어왔다면,
            // ? 그리고 스크롤이 산타가 튀어나오는 영역을 벗어나지 않았다면, (벗어나면 멈춰야함. 그래서 엘리먼트위 상단과 높이를 더한 값을 비교함)
            if (scrollYBottom > panel1Img.offsetTop && scrollYBottom < panel1Img.offsetTop + panel1Img.offsetHeight + 100) {
                // * 축 이동과 각도 변화가 일어남
                // * 초기 값 80은 CSS에서 미리 있던 값
                const translateX =
                    80 - // ? 스크롤 내리기 전엔 80이어야 하고 내리면서 0으로 가야함
                    (80 * 1.3 * (scrollYBottom - panel1Img.offsetTop)) / // ? 1.3은 80에서 0으로 가는데 1.3배 더 빠르게, 많이 움직이게 하기 위함
                        (panel1Img.offsetHeight + 100); // ? 스크롤 바텀에서 이미지 탑을 빼고 이미지 전체 높이를 나눔
                const translateY = -13 + (13 * (scrollYBottom - panel1Img.offsetTop)) / (panel1Img.offsetHeight + 100);
                const rotationDegree = 23 - (23 * 1.7 * (scrollYBottom - panel1Img.offsetTop)) / (panel1Img.offsetHeight + 100);

                flyingSantaImage.style.transform = `translate(${translateX}px, ${translateY}px) rotate(${rotationDegree}deg)`;
            }
        });
    </script>
</html>
